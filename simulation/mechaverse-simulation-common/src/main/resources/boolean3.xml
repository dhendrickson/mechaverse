<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<CellularAutomatonDescriptor xmlns="http://www.mechaverse.org/cellautomaton/model" 
    width="16" height="16" iterationsPerUpdate="200">

  <!-- An element that outputs an input value. -->
  <CellType id="input">
    <Output id="1" constant="true" >
      <Param id="idx" />
      <UpdateExpression><![CDATA[
        automatonInput[{idx} % automatonInputLength]
	  ]]></UpdateExpression>
    </Output>
  </CellType>

  <CellType id="boolean3in3out">
    <Param id="nextOutput" />
    <Output id="1">
      <Param id="param1" />
      <Param id="param2" />
      <Param id="param3" />
      <Param id="param4" />
      <Param id="param5" />
      <Param id="param6" />
      <Param id="param7" />
      <Param id="param8" />
            
      <BeforeUpdate><![CDATA[
        {nextOutput} = ((({input1} & {input2}) & ({input3} & {param1} | ~{input3} & {param2})) | 
                        (({input1} & ~{input2}) & ({input3} & {param3} | ~{input3} & {param4})) |
                        ((~{input1} & {input2}) & ({input3} & {param5} | ~{input3} & {param6})) |
                        ((~{input1} & ~{input2} & {input3}) & {param7}) ) ^ {param8}; 
      ]]></BeforeUpdate>
      <UpdateExpression><![CDATA[
        {nextOutput}
      ]]></UpdateExpression>
    </Output>
  </CellType>

  <LogicalUnit neighborConnections="3" >
    <row>
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
    </row>
    <row>
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
    </row>
    <row>
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
    </row>
    <row>
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
      <Cell type="boolean3in3out" />
    </row>
  </LogicalUnit>
</CellularAutomatonDescriptor>